<!DOCTYPE html>
<html lang="ja">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
<title>ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ãƒ„ãƒ¼ãƒ«</title>
<link rel="manifest" href="manifest.json">
<meta name="theme-color" content="#B0E0E6">
<link rel="apple-touch-icon" href="icon-192.png">

<style>
body { font-family:-apple-system,BlinkMacSystemFont,"ãƒ¡ã‚¤ãƒªã‚ª",sans-serif; padding:15px; background:#B0E0E6; color:#000; }
h1 { text-align:center; font-size:1.8em; margin-bottom:10px; }
p { text-align:center; font-size:0.9em; color:#333; margin-bottom:15px; }
button { display:block; width:100%; padding:12px; margin:10px 0; font-size:16px; background:#B3F5DD; color:#000; border:none; border-radius:8px; cursor:pointer; }
button:hover { opacity:0.8; }
#result { white-space:pre-wrap; background-color:#fff; color:#000; padding:15px; border-radius:10px; margin-top:20px; font-family:"Courier New",monospace; font-size:15px; max-height:300px; overflow-y:auto; }
#nameGrid { display:grid; grid-template-columns:1fr 1fr; gap:8px; margin-bottom:10px; }
.nameItem { display:flex; align-items:center; padding:6px 10px; border:1px solid #444; border-radius:6px; background:#fff; cursor:pointer; }
.nameItem.selected { background:#D1E8E2; }
.nameItem input { width:16px; height:16px; margin-right:8px; accent-color:#000; }

/* ãƒ¢ãƒ¼ãƒ€ãƒ«å…±é€šï¼ˆiOSã§ã‚­ãƒ¼ãƒœãƒ¼ãƒ‰ãŒå‡ºã‚‹ã‚ˆã†ã«èª¿æ•´ï¼‰ */
.overlay { display:none; position:absolute; top:0; left:0; width:100%; height:100%; background:rgba(0,0,0,0.5); padding:24px 16px; box-sizing:border-box; overflow:auto; z-index:9999; }
.modal { background:#fff; padding:18px; border-radius:12px; width:100%; max-width:400px; margin:40px auto; box-sizing:border-box; max-height:90vh; overflow:auto; }
.modal h2 { margin:0 0 12px 0; font-size:1.2em; }
.modal input { width:calc(100% - 24px); box-sizing:border-box; padding:10px 12px; margin:8px 0; border-radius:8px; border:1px solid #333; text-align:center; font-size:16px; }

.actions { display:flex; gap:12px; margin-top:16px; }
.actions button { flex:1; border-radius:8px; font-size:15px; padding:10px; }
.actions .cancel { background:#ccc; }
.actions .submit { background:#B3F5DD; }

#deleteList { margin-top:12px; display:grid; grid-template-columns:1fr 1fr; gap:8px; }
.deleteItem { display:flex; align-items:center; padding:6px 10px; border:1px solid #444; border-radius:6px; background:#fff; }
.deleteItem input { width:16px; height:16px; margin-right:8px; accent-color:#000; }
</style>
</head>
<body>
<h1>ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ãƒ„ãƒ¼ãƒ«</h1>
<p>ãƒã‚§ãƒƒã‚¯ã‚’å…¥ã‚ŒãŸäººã ã‘ã§ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ã§ãã¾ã™ï¼ˆå‡ºåŠ›æ™‚ã«ã€Œã¡ã‚ƒã‚“ã€ãŒä»˜ãã¾ã™ï¼‰</p>

<button onclick="openModal()">ğŸ‘¤ ï¼‹æ–°è¦ç™»éŒ²</button>
<button onclick="openDeleteModal()">ğŸ—‘ ãƒ¡ãƒ³ãƒãƒ¼å‰Šé™¤</button>

<div id="nameGrid"></div>

<button onclick="makeGroups()">ğŸ‘» ã‚°ãƒ«ãƒ¼ãƒ—ä½œæˆ</button>
<button onclick="resetResult()">ğŸ—‘ å±¥æ­´ãƒªã‚»ãƒƒãƒˆ</button>
<button onclick="copyResult()">âœ”ï¸ çµæœã‚’ã‚³ãƒ”ãƒ¼</button>

<div id="result"></div>

<div id="modalOverlay" class="overlay">
  <div class="modal">
    <h2>ğŸ†• ãƒ¡ãƒ³ãƒãƒ¼ç™»éŒ²</h2>
    <input type="text" id="newDisplay" placeholder="è¡¨ç¤ºåã‚’å…¥åŠ›">
    <input type="text" id="newOutput" placeholder="å‡ºåŠ›åã‚’å…¥åŠ›">
    <div class="actions">
      <button class="cancel" onclick="closeModal()">ã‚­ãƒ£ãƒ³ã‚»ãƒ«</button>
      <button class="submit" onclick="addMember()">ç™»éŒ²ã™ã‚‹</button>
    </div>
  </div>
</div>

<div id="deleteModalOverlay" class="overlay">
  <div class="modal">
    <h2>âš  å‰Šé™¤ã™ã‚‹ãƒ¡ãƒ³ãƒãƒ¼ã‚’é¸æŠ</h2>
    <div id="deleteList"></div>
    <div class="actions">
      <button class="cancel" onclick="closeDeleteModal()">é–‰ã˜ã‚‹</button>
      <button class="submit" onclick="deleteSelected()">å‰Šé™¤</button>
    </div>
  </div>
</div>

<script>
let members=[{display:"Hei",output:"ã¸ã„ã¡ã‚ƒã‚“"},{display:"sabaris",output:"ã•ã°ã¡ã‚ƒã‚“"},{display:"Lapis",output:"ãƒ©ãƒ”ã¡ã‚ƒã‚“"},{display:"TAMA",output:"ãŸã¾ã¡ã‚ƒã‚“"},{display:"ã—ã°ã˜ã‚ã†",output:"ã—ã°ã¡ã‚ƒã‚“"},{display:"ã‚«ã‚¤",output:"ã‚«ã‚¤ã¡ã‚ƒã‚“"},{display:"ã—ã‚å­",output:"ã—ã‚ã¡ã‚ƒã‚“"},{display:"ã‚µã‚¯ãƒ¤",output:"ã‚ã‚“ã‚ã‚“ã‚µã‚¯ã¡ã‚ƒã‚“"},{display:"ã™ã„",output:"ã™ã„ã¡ã‚ƒã‚“"},{display:"ãŸã„",output:"ãŸã„ã¡ã‚ƒã‚“"},{display:"ãŸã‹ã“ã£ã“",output:"ãŸã‹ã¡ã‚ƒã‚“"},{display:"ã¬ãƒ¼ãˆ",output:"ã¬ãˆã¡ã‚ƒã‚“"},{display:"ã¾ã¿ã¿",output:"ã¾ã¿ã¡ã‚ƒã‚“"},{display:"ã¾ã‚ã—ã°ããã",output:"ã¾ã‚ã¡ã‚ƒã‚“"},{display:"ã¿ï½ã“",output:"ã¿ï½ã¡ã‚ƒã‚“"},{display:"ã‚ãŒã‚€ãƒ¼",output:"ã‚ãŒã¡ã‚ƒã‚“"},{display:"ã‚‚ã‚‚ã‚“ãŒ",output:"ã‚‚ã‚‚ã¡ã‚ƒã‚“"},{display:"ã‚Šã‚",output:"ã‚Šã‚ã¡ã‚ƒã‚“"},{display:"ã‚¢ã‚¤ãƒªãƒ¼ãƒ³",output:"ã‚¢ã‚¤ã¡ã‚ƒã‚“"},{display:"ã‚³ãƒ­ãƒœãƒƒã‚¯ãƒ«",output:"ã‚³ãƒ­ã¡ã‚ƒã‚“"},{display:"ãƒ‡ã‚£ãƒ»ãƒãƒªã‚¢å¤§ä½",output:"ãƒ™ã‚¸ãƒ¼ã‚¿ã¡ã‚ƒã‚“"},{display:"ãƒŸã‚ºã‚­",output:"ãƒŸã‚ºã¡ã‚ƒã‚“"},{display:"ãƒ¡ãƒ¡ãƒã‚¢",output:"ãƒ¡ãƒ¡ã¡ã‚ƒã‚“"},{display:"èŒ¶ã€…",output:"ã¡ã‚ƒã¡ã‚ƒã¡ã‚ƒã‚“"},{display:"Ren",output:"ãƒ¬ãƒ³ã¡ã‚ƒã‚“"},{display:"ã‚·ãƒ³ãƒã‚¹ã‚±",output:"ã—ã‚“ã¡ã‚ƒã‚“"},{display:"Echidna",output:"ã‚¨ã‚­ã¡ã‚ƒã‚“"}];

function renderGrid(){
  const grid=document.getElementById("nameGrid"); grid.innerHTML="";
  members.forEach((m,idx)=>{
    const item=document.createElement("div"); item.className="nameItem";
    const cb=document.createElement("input"); cb.type="checkbox"; cb.id="chk"+idx;
    const label=document.createElement("label"); label.setAttribute("for","chk"+idx); label.textContent=m.display;
    cb.addEventListener("change",()=>{item.classList.toggle("selected",cb.checked)});
    item.appendChild(cb); item.appendChild(label);
    grid.appendChild(item);
  });
}
renderGrid();

/* æ–°è¦ç™»éŒ² */
function openModal(){ document.getElementById("modalOverlay").style.display="block"; }
function closeModal(){ document.getElementById("modalOverlay").style.display="none"; }
function addMember(){
  const d=document.getElementById("newDisplay").value.trim();
  const o=document.getElementById("newOutput").value.trim();
  if(!d||!o)return;
  if(members.some(m=>m.display===d)){ alert("åŒåã®ãƒ¡ãƒ³ãƒãƒ¼ã¯ç™»éŒ²ã§ãã¾ã›ã‚“"); return; }
  members.push({ display:d, output:o+"ã¡ã‚ƒã‚“" });
  renderGrid(); closeModal();
  document.getElementById("newDisplay").value=""; document.getElementById("newOutput").value="";
}

/* ãƒ¡ãƒ³ãƒãƒ¼å‰Šé™¤ */
function openDeleteModal(){ 
  document.getElementById("deleteModalOverlay").style.display="block"; 
  const list=document.getElementById("deleteList"); list.innerHTML="";
  members.forEach((m,idx)=>{
    const item=document.createElement("div"); item.className="deleteItem";
    const cb=document.createElement("input"); cb.type="checkbox"; cb.id="del"+idx;
    const label=document.createElement("label"); label.setAttribute("for","del"+idx); label.textContent=m.display;
    item.appendChild(cb); item.appendChild(label);
    list.appendChild(item);
  });
}
function closeDeleteModal(){ document.getElementById("deleteModalOverlay").style.display="none"; }
function deleteSelected(){
  const toDel=[]; members.forEach((m,idx)=>{ const cb=document.getElementById("del"+idx); if(cb.checked) toDel.push(idx); });
  if(toDel.length===0) return; if(!confirm("ã“ã®ãƒ¡ãƒ³ãƒãƒ¼ã‚’å‰Šé™¤ã—ã¾ã™ã‹ï¼Ÿ")) return;
  for(let i=toDel.length-1;i>=0;i--){ members.splice(toDel[i],1); }
  renderGrid(); closeDeleteModal();
}

/* ã‚°ãƒ«ãƒ¼ãƒ—åˆ†ã‘ */
let historyLog={};
function makeGroups(){
  const checkedMembers=[]; members.forEach((m,idx)=>{ const cb=document.getElementById("chk"+idx); if(cb.checked) checkedMembers.push(m.output); });
  if(checkedMembers.length===0) return;
  for(let i=checkedMembers.length-1;i>0;i--){ const j=Math.floor(Math.random()*(i+1)); [checkedMembers[i],checkedMembers[j]]=[checkedMembers[j],checkedMembers[i]]; }

  const groupSizes=[]; let rem=checkedMembers.length;
  while(rem>0){ if(rem>=4){ groupSizes.push(4); rem-=4; } else { groupSizes.push(rem); rem=0; } }

  const groups=[]; let idx=0; for(let size of groupSizes){ groups.push(checkedMembers.slice(idx,idx+size)); idx+=size; }

  const labels="ABCDEFGHIJKLMNOPQRSTUVWXYZ"; const now=new Date();
  const dateStr=now.toLocaleDateString("ja-JP",{year:"2-digit",month:"2-digit",day:"2-digit"})+" "+now.toTimeString().slice(0,5);
  let output="â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†\n"+dateStr+" æ™‚ç‚¹\nâ€»å·¦ã®äººã‹ã‚‰è²¼ã£ã¦ã„ã“ãƒ¼ï¼\n\n";
  groups.forEach((g,i)=>{ output+=`ï½¸ï¾ï¾™ï½°ï¾Œï¾Ÿ${labels[i]}ï¼ˆ${g.length}äººï¼‰ï¼š${g.join("ã€")}\n-------------------------------\n`; });
  output+="\nâ˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†â˜†";
  document.getElementById("result").innerText=output;
}

function resetResult(){ document.getElementById("result").innerText=""; historyLog={}; }
function copyResult(){ navigator.clipboard.writeText(document.getElementById("result").innerText).then(()=>alert("çµæœã‚’ã‚³ãƒ”ãƒ¼ã—ã¾ã—ãŸï¼"),err=>alert("ã‚³ãƒ”ãƒ¼ã«å¤±æ•—ã—ã¾ã—ãŸ: "+err)); }
</script>
</body>
</html>
